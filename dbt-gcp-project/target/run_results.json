{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2025.7.1+19af45b", "generated_at": "2025-07-02T19:47:37.776682Z", "invocation_id": "dc165ed1-24b5-4034-bd0a-4f29316254fb", "invocation_started_at": "2025-07-02T19:47:21.055717Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-02T19:47:32.234595Z", "completed_at": "2025-07-02T19:47:32.242068Z"}, {"name": "execute", "started_at": "2025-07-02T19:47:32.259602Z", "completed_at": "2025-07-02T19:47:35.304859Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.0853426456451416, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 30.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 31200, "bytes_billed": 10485760, "location": "europe-west3", "project_id": "my-dbt-project-4321790", "job_id": "94f18c0c-f489-4afd-9720-926c3652cef7", "slot_ms": 155}, "message": "CREATE TABLE (1.0 rows, 30.5 KiB processed)", "failures": null, "unique_id": "model.my_new_project.previous_purchases_distrib", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n  SELECT\n    customer_id,\n    previous_purchases\n  FROM `my-dbt-project-4321790`.`shopping_sales`.`shopping_trends_updated`\n)\n\nSELECT\n  COUNT(*) as customer_count,\n  AVG(previous_purchases) as avg_purchases,\n  STDDEV(previous_purchases) as stddev_purchases,\n  APPROX_QUANTILES(previous_purchases, 100)[OFFSET(25)] as p25,\n  APPROX_QUANTILES(previous_purchases, 100)[OFFSET(50)] as median,\n  APPROX_QUANTILES(previous_purchases, 100)[OFFSET(75)] as p75,\n  APPROX_QUANTILES(previous_purchases, 100)[OFFSET(90)] as p90\nFROM source_data", "relation_name": "`my-dbt-project-4321790`.`shopping_trends_updated`.`previous_purchases_distrib`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-02T19:47:32.230874Z", "completed_at": "2025-07-02T19:47:32.241107Z"}, {"name": "execute", "started_at": "2025-07-02T19:47:32.253324Z", "completed_at": "2025-07-02T19:47:35.307601Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.0891683101654053, "adapter_response": {"_message": "CREATE TABLE (3.9k rows, 138.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3900, "bytes_processed": 141453, "bytes_billed": 10485760, "location": "europe-west3", "project_id": "my-dbt-project-4321790", "job_id": "c0445536-812a-4936-85cd-dfba4ade450a", "slot_ms": 1412}, "message": "CREATE TABLE (3.9k rows, 138.1 KiB processed)", "failures": null, "unique_id": "model.my_new_project.int_customer_segmentation", "compiled": true, "compiled_code": "\n\nWITH customer_data AS (\n  SELECT\n    Customer_ID,\n    -- Ekstrakcja cech klienta (1 wiersz = 1 klient)\n    MAX(CAST(Previous_Purchases AS INT64)) AS lifetime_purchases,\n    MAX(CAST(Purchase_Amount__USD_ AS NUMERIC)) AS max_order_value,\n    MAX(Review_Rating) AS avg_rating,\n    LOGICAL_OR(Subscription_Status = 'Yes') AS is_subscriber\n  FROM `my-dbt-project-4321790`.`shopping_sales`.`shopping_trends_updated`\n  GROUP BY Customer_ID\n)\n\nSELECT\n  Customer_ID,\n  lifetime_purchases,\n  avg_rating,\n  is_subscriber,\n  -- Segmentacja oparta o statystyki kt\u00f3re obliczy\u0142e\u015b wcze\u015bniej\n  CASE\n    WHEN lifetime_purchases >= 38 THEN 'VIP'          -- powy\u017cej p75 (Twoje dane)\n    WHEN lifetime_purchases >= 13 THEN 'Returning'    -- mi\u0119dzy p25 a p75\n    ELSE 'New'                                        -- poni\u017cej p25\n  END AS customer_segment,\n  -- Dodatkowa segmentacja warto\u015bciowa\n  CASE\n    WHEN max_order_value > 100 THEN 'High Spender'\n    WHEN max_order_value > 50 THEN 'Medium Spender'\n    ELSE 'Low Spender'\n  END AS spending_tier\nFROM customer_data", "relation_name": "`my-dbt-project-4321790`.`shopping_trends_updated`.`int_customer_segmentation`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-02T19:47:32.236486Z", "completed_at": "2025-07-02T19:47:32.242607Z"}, {"name": "execute", "started_at": "2025-07-02T19:47:32.260869Z", "completed_at": "2025-07-02T19:47:35.438334Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.2178776264190674, "adapter_response": {"_message": "CREATE TABLE (299.0 rows, 156.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 299, "bytes_processed": 160167, "bytes_billed": 10485760, "location": "europe-west3", "project_id": "my-dbt-project-4321790", "job_id": "580d8d45-f2d5-45dd-b04d-0cdc51118fbd", "slot_ms": 268}, "message": "CREATE TABLE (299.0 rows, 156.4 KiB processed)", "failures": null, "unique_id": "model.my_new_project.review_rating_analysis", "compiled": true, "compiled_code": "-- models/marts/analysis/review_rating_analysis.sql\n\n\nWITH rating_buckets AS (\n  SELECT\n    CASE\n      WHEN Review_Rating >= 4.5 THEN '4.5-5.0'\n      WHEN Review_Rating >= 4.0 THEN '4.0-4.4'\n      ELSE '<4.0'\n    END AS rating_group,\n    *\n  FROM `my-dbt-project-4321790`.`shopping_sales`.`shopping_trends_updated`\n)\n\nSELECT\n  rating_group,\n  Gender,\n  Location,\n  ROUND(AVG(CAST(Age AS INT64)), 1) AS avg_age,\n  COUNT(*) AS review_count,\n  ROUND(AVG(CAST(Purchase_Amount__USD_ AS NUMERIC)), 2) AS avg_spend\nFROM rating_buckets\nGROUP BY rating_group, Gender, Location\nORDER BY rating_group, review_count DESC", "relation_name": "`my-dbt-project-4321790`.`shopping_trends_updated`.`review_rating_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-02T19:47:32.224237Z", "completed_at": "2025-07-02T19:47:32.240619Z"}, {"name": "execute", "started_at": "2025-07-02T19:47:32.243056Z", "completed_at": "2025-07-02T19:47:35.458604Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.2431347370147705, "adapter_response": {"_message": "CREATE TABLE (16.0 rows, 72.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 16, "bytes_processed": 74244, "bytes_billed": 10485760, "location": "europe-west3", "project_id": "my-dbt-project-4321790", "job_id": "88d38ad0-48f2-4d1d-9339-73fdc0aeb27a", "slot_ms": 323}, "message": "CREATE TABLE (16.0 rows, 72.5 KiB processed)", "failures": null, "unique_id": "model.my_new_project.age_category_analysis", "compiled": true, "compiled_code": "\n\n\nwith age_groups AS (\n    SELECT\n        CASE\n            \n            WHEN Age < 20 then 'Under 20'\n            \n            WHEN Age < 35 then 'Under 35'\n            \n            WHEN Age < 50 then 'Under 50'\n            \n            ELSE 'Over 50'\n        END as age_group,\n        *\n        FROM `my-dbt-project-4321790`.`shopping_sales`.`shopping_trends_updated`\n)\n\nSELECT\n    age_group,\n    Category,\n    COUNT(*) as purchase_count,\n    ROUND(COUNT(*) * 100 / SUM(count(*)) OVER (PARTITION BY age_group ORDER BY age_group), 1) AS percentage_in_age_group\nFROM age_groups\nGROUP BY age_group, Category\nORDER BY age_group, purchase_count DESC", "relation_name": "`my-dbt-project-4321790`.`shopping_trends_updated`.`age_category_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-02T19:47:32.238381Z", "completed_at": "2025-07-02T19:47:32.257951Z"}, {"name": "execute", "started_at": "2025-07-02T19:47:32.358541Z", "completed_at": "2025-07-02T19:47:35.560037Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 3.3385024070739746, "adapter_response": {"_message": "CREATE TABLE (50.0 rows, 131.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 50, "bytes_processed": 134271, "bytes_billed": 10485760, "location": "europe-west3", "project_id": "my-dbt-project-4321790", "job_id": "56e72331-d268-45ff-9da5-3ab852863ced", "slot_ms": 219}, "message": "CREATE TABLE (50.0 rows, 131.1 KiB processed)", "failures": null, "unique_id": "model.my_new_project.state_customer_analysis", "compiled": true, "compiled_code": "\n\nSELECT \n    Location AS state,\n    count(distinct Customer_ID) as unique_customers,\n    round(AVG(CAST(AGE AS INT64)),1)as avg_age,\n    SUM(CAST(Previous_Purchases as INT64)) as total_previous_purchases,\n    ROUND(SUM(CAST(Previous_Purchases as INT64))/COUNT(distinct Customer_ID), 1) as avg_purchases_per_customer\nFROM `my-dbt-project-4321790`.`shopping_sales`.`shopping_trends_updated`\nGROUP BY Location\nOrder By avg_purchases_per_customer DESC", "relation_name": "`my-dbt-project-4321790`.`shopping_trends_updated`.`state_customer_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-02T19:47:32.232811Z", "completed_at": "2025-07-02T19:47:32.241522Z"}, {"name": "execute", "started_at": "2025-07-02T19:47:32.258404Z", "completed_at": "2025-07-02T19:47:35.889076Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.6699352264404297, "adapter_response": {"_message": "CREATE TABLE (6.0 rows, 69.0 KiB processed)", "code": "CREATE TABLE", "rows_affected": 6, "bytes_processed": 70609, "bytes_billed": 10485760, "location": "europe-west3", "project_id": "my-dbt-project-4321790", "job_id": "7bc9979b-f65d-4e2e-a6ef-419d4a477b45", "slot_ms": 2931}, "message": "CREATE TABLE (6.0 rows, 69.0 KiB processed)", "failures": null, "unique_id": "model.my_new_project.payment_method_analysis", "compiled": true, "compiled_code": "\n\nSELECT\n  Payment_Method,\n  COUNT(*) AS transaction_count,\n  SUM(CAST(Purchase_Amount__USD_ AS NUMERIC)) AS total_revenue,\n  ROUND(SUM(CAST(Purchase_Amount__USD_ AS NUMERIC)) / COUNT(*), 2) AS avg_order_value,\n  ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 1) AS percentage_of_orders\nFROM `my-dbt-project-4321790`.`shopping_sales`.`shopping_trends_updated`\nGROUP BY Payment_Method\nORDER BY total_revenue DESC", "relation_name": "`my-dbt-project-4321790`.`shopping_trends_updated`.`payment_method_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-02T19:47:35.314189Z", "completed_at": "2025-07-02T19:47:35.316132Z"}, {"name": "execute", "started_at": "2025-07-02T19:47:35.316554Z", "completed_at": "2025-07-02T19:47:37.731148Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 2.418130874633789, "adapter_response": {"_message": "CREATE TABLE (2.0 rows, 77.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 2, "bytes_processed": 79053, "bytes_billed": 10485760, "location": "europe-west3", "project_id": "my-dbt-project-4321790", "job_id": "2be26b13-13cc-47d5-86d6-9a864438aa86", "slot_ms": 1709}, "message": "CREATE TABLE (2.0 rows, 77.2 KiB processed)", "failures": null, "unique_id": "model.my_new_project.subscription_impact", "compiled": true, "compiled_code": "-- models/marts/analysis/subscription_impact.sql\n\n\nSELECT\n  Subscription_Status,\n  COUNT(*) AS order_count,\n  SUM(CAST(Purchase_Amount__USD_ AS NUMERIC)) AS total_revenue,\n  ROUND(AVG(CAST(Purchase_Amount__USD_ AS NUMERIC)), 2) AS avg_order_value,\n  SUM(CAST(Previous_Purchases AS INT64)) AS lifetime_purchases,\n  ROUND(AVG(CAST(Previous_Purchases AS INT64)), 1) AS avg_previous_purchases\nFROM `my-dbt-project-4321790`.`shopping_sales`.`shopping_trends_updated`\nGROUP BY Subscription_Status", "relation_name": "`my-dbt-project-4321790`.`shopping_trends_updated`.`subscription_impact`", "batch_results": null}], "elapsed_time": 6.287377595901489, "args": {"version_check": true, "log_path": "logs", "log_level_file": "debug", "exclude": [], "invocation_command": "dbt ", "log_format": "json", "skip_nodes_if_on_run_start_fails": false, "skip_semantic_layer": false, "upload_to_artifacts_ingest_api": false, "require_all_warnings_handled_by_warn_error": false, "vortex_event_forwarding_enabled": false, "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "state_modified_compare_vars": false, "profile": "user", "write_json": true, "target_path": "target", "introspect": true, "print": true, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "skip_write_msgpack_if_exist": false, "use_fast_test_edges": false, "log_format_file": "json", "log_level": "info", "strict_mode": false, "indirect_selection": "eager", "project_dir": "/app/dbt_project/dc50c1a2-3072-4d30-bed8-da0fc2ca6d29", "defer": false, "use_colors_file": true, "profiles_dir": "./", "static_parser": true, "use_colors": true, "which": "run", "partial_parse_file_diff": true, "state_modified_compare_more_unrendered_values": false, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "validate_macro_args": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "macro_debugging": false, "empty": false, "populate_cache": true, "require_yaml_configuration_for_mf_time_spines": false, "send_anonymous_usage_stats": true, "log_file_max_bytes": 0, "require_resource_names_without_spaces": true, "show_resource_report": false, "favor_state": false, "quiet": false, "printer_width": 80, "cache_selected_only": false}}